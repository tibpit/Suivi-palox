<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #519ce9}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #9ba2b1}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #d65562}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #88b966}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #9ba2b1; min-height: 16.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #c58853}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px '.AppleSystemUIFontMonospaced'; color: #4a505d}
    span.s1 {color: #b85dd5}
    span.s2 {color: #d65562}
    span.s3 {color: #c58853}
    span.s4 {color: #88b966}
    span.s5 {color: #9ba2b1}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE <span class="s1">html</span>&gt;</p>
<p class="p2">&lt;<span class="s2">html</span> <span class="s3">lang</span>=<span class="s4">"fr"</span>&gt;</p>
<p class="p3"><span class="s5">&lt;</span>head<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">  </span>&lt;<span class="s2">meta</span> <span class="s3">charset</span>=<span class="s4">"UTF-8"</span> /&gt;</p>
<p class="p2"><span class="Apple-converted-space">  </span>&lt;<span class="s2">title</span>&gt;Suivi des containers - Eco in Pack&lt;/<span class="s2">title</span>&gt;</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span><span class="s2">meta</span><span class="s5"> </span><span class="s3">name</span><span class="s5">=</span>"viewport"<span class="s5"> </span><span class="s3">content</span><span class="s5">=</span>"width=device-width, initial-scale=1.0"<span class="s5"> /&gt;</span></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span><span class="s2">script</span><span class="s5"> </span><span class="s3">src</span><span class="s5">=</span>"https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"<span class="s5">&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span>style<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">    </span><span class="s2">body</span> {</p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">font-family</span>: sans-serif;</p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">padding</span>: <span class="s3">20px</span>;</p>
<p class="p2"><span class="Apple-converted-space">    </span>}</p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span></span>input<span class="s5">, </span>select<span class="s5">, </span>button<span class="s5"> {</span></p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">font-size</span>: <span class="s3">16px</span>;</p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">padding</span>: <span class="s3">8px</span>;</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">      </span></span>margin-top<span class="s5">: </span><span class="s3">10px</span><span class="s5">;</span></p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">width</span>: <span class="s3">100%</span>;</p>
<p class="p2"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="s5"><span class="Apple-converted-space">    </span></span>#form-container<span class="s5"> {</span></p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s4">display</span>: none;</p>
<p class="p2"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><span class="Apple-converted-space">  </span>&lt;/<span class="s2">style</span>&gt;</p>
<p class="p3"><span class="s5">&lt;/</span>head<span class="s5">&gt;</span></p>
<p class="p3"><span class="s5">&lt;</span>body<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">  </span>&lt;<span class="s2">h2</span>&gt;Scanner un container&lt;/<span class="s2">h2</span>&gt;</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span><span class="s2">div</span><span class="s5"> </span><span class="s3">id</span><span class="s5">=</span>"reader"<span class="s5"> </span><span class="s3">style</span><span class="s5">=</span>"width:100%; max-width:400px;"<span class="s5">&gt;&lt;/</span><span class="s2">div</span><span class="s5">&gt;</span></p>
<p class="p5"><br></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span><span class="s2">div</span><span class="s5"> </span><span class="s3">id</span><span class="s5">=</span>"form-container"<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">    </span>&lt;<span class="s2">h3</span> <span class="s3">id</span>=<span class="s4">"container-id"</span>&gt;Container&lt;/<span class="s2">h3</span>&gt;</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">form</span><span class="s5"> </span><span class="s3">id</span><span class="s5">=</span>"update-form"<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;<span class="s2">label</span>&gt;Où est ce container ?&lt;/<span class="s2">label</span>&gt;</p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">      </span>&lt;</span><span class="s2">select</span><span class="s5"> </span>name<span class="s5">=</span><span class="s4">"location"</span><span class="s5"> </span>required<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">        </span>&lt;<span class="s2">option</span> <span class="s3">value</span>=<span class="s4">"Chez nous"</span>&gt;Chez nous&lt;/<span class="s2">option</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span>&lt;<span class="s2">option</span> <span class="s3">value</span>=<span class="s4">"Chez client"</span>&gt;Chez client&lt;/<span class="s2">option</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;/<span class="s2">select</span>&gt;</p>
<p class="p5"><br></p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;<span class="s2">label</span>&gt;Client (si chez client) :&lt;/<span class="s2">label</span>&gt;</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">      </span>&lt;</span><span class="s2">input</span><span class="s5"> </span><span class="s3">list</span><span class="s5">=</span>"clients"<span class="s5"> </span><span class="s3">name</span><span class="s5">=</span>"client"<span class="s5"> /&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;<span class="s2">datalist</span> <span class="s3">id</span>=<span class="s4">"clients"</span>&gt;</p>
<p class="p7"><span class="s5"><span class="Apple-converted-space">        </span></span>&lt;!-- Tu rempliras dynamiquement ici selon ta feuille --&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span>&lt;<span class="s2">option</span> <span class="s3">value</span>=<span class="s4">"Client A"</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span>&lt;<span class="s2">option</span> <span class="s3">value</span>=<span class="s4">"Client B"</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;/<span class="s2">datalist</span>&gt;</p>
<p class="p5"><br></p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">      </span>&lt;</span><span class="s2">input</span><span class="s5"> </span><span class="s3">type</span><span class="s5">=</span>"hidden"<span class="s5"> </span><span class="s3">name</span><span class="s5">=</span>"id"<span class="s5"> </span><span class="s3">id</span><span class="s5">=</span>"container-id-hidden"<span class="s5"> /&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">      </span>&lt;<span class="s2">button</span> <span class="s3">type</span>=<span class="s4">"submit"</span>&gt;Mettre à jour&lt;/<span class="s2">button</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span>&lt;/<span class="s2">form</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span>&lt;<span class="s2">div</span> <span class="s3">id</span>=<span class="s4">"result"</span>&gt;&lt;/<span class="s2">div</span>&gt;</p>
<p class="p2"><span class="Apple-converted-space">  </span>&lt;/<span class="s2">div</span>&gt;</p>
<p class="p5"><br></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span>&lt;</span>script<span class="s5">&gt;</span></p>
<p class="p2"><span class="Apple-converted-space">    </span><span class="s1">const</span> formContainer = document.getElementById(<span class="s4">"form-container"</span>);</p>
<p class="p2"><span class="Apple-converted-space">    </span><span class="s1">const</span> reader = <span class="s1">new</span> Html5Qrcode(<span class="s4">"reader"</span>);</p>
<p class="p5"><br></p>
<p class="p2"><span class="Apple-converted-space">    </span>reader.start(</p>
<p class="p2"><span class="Apple-converted-space">      </span>{ <span class="s3">facingMode</span>: <span class="s4">"environment"</span> },</p>
<p class="p2"><span class="Apple-converted-space">      </span>{</p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s3">fps</span>: <span class="s3">10</span>,</p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s3">qrbox</span>: <span class="s3">250</span></p>
<p class="p2"><span class="Apple-converted-space">      </span>},</p>
<p class="p2"><span class="Apple-converted-space">      </span>qrCodeMessage =&gt; {</p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s1">const</span> parts = qrCodeMessage.split(<span class="s4">"/"</span>);</p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s1">const</span> id = parts[parts.length - <span class="s3">1</span>];</p>
<p class="p2"><span class="Apple-converted-space">        </span>document.getElementById(<span class="s4">"container-id"</span>).innerText = <span class="s4">"Container : "</span> + id;</p>
<p class="p2"><span class="Apple-converted-space">        </span>document.getElementById(<span class="s4">"container-id-hidden"</span>).value = id;</p>
<p class="p2"><span class="Apple-converted-space">        </span>formContainer.style.display = <span class="s4">"block"</span>;</p>
<p class="p2"><span class="Apple-converted-space">        </span>reader.stop();</p>
<p class="p2"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><span class="Apple-converted-space">    </span>).catch(err =&gt; {</p>
<p class="p2"><span class="Apple-converted-space">      </span>console.error(<span class="s4">"Erreur scan:"</span>, err);</p>
<p class="p2"><span class="Apple-converted-space">    </span>});</p>
<p class="p5"><br></p>
<p class="p2"><span class="Apple-converted-space">    </span>document.getElementById(<span class="s4">"update-form"</span>).addEventListener(<span class="s4">"submit"</span>, <span class="s1">function</span> (e) {</p>
<p class="p2"><span class="Apple-converted-space">      </span>e.preventDefault();</p>
<p class="p2"><span class="Apple-converted-space">      </span><span class="s1">const</span> formData = <span class="s1">new</span> FormData(e.target);</p>
<p class="p4"><span class="s5"><span class="Apple-converted-space">      </span>fetch(</span>"https://script.google.com/a/macros/5autels.com/s/AKfycbyOY_ODRDmfK80KB_IeqHeeSrsvgqmUNyNwIjH71vSiRLsd-G8B8d9f1j5MH8KiamW_/exec"<span class="s5">, {</span></p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s3">method</span>: <span class="s4">"POST"</span>,</p>
<p class="p2"><span class="Apple-converted-space">        </span><span class="s3">body</span>: formData</p>
<p class="p2"><span class="Apple-converted-space">      </span>})</p>
<p class="p2"><span class="Apple-converted-space">      </span>.then(response =&gt; response.text())</p>
<p class="p2"><span class="Apple-converted-space">      </span>.then(result =&gt; {</p>
<p class="p2"><span class="Apple-converted-space">        </span>document.getElementById(<span class="s4">"result"</span>).innerText = result;</p>
<p class="p2"><span class="Apple-converted-space">        </span>e.target.reset();</p>
<p class="p2"><span class="Apple-converted-space">      </span>});</p>
<p class="p2"><span class="Apple-converted-space">    </span>});</p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">  </span>&lt;/</span>script<span class="s5">&gt;</span></p>
<p class="p3"><span class="s5">&lt;/</span>body<span class="s5">&gt;</span></p>
<p class="p3"><span class="s5">&lt;/</span>html<span class="s5">&gt;</span></p>
</body>
</html>
